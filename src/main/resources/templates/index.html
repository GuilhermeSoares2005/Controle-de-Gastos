<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle de Gastos</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            color-scheme: light dark;
            font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: #f5f6fb;
        }

        body {
            margin: 0;
            padding: 2rem 1rem 4rem;
            min-height: 100vh;
            background: linear-gradient(180deg, #f5f6fb 0%, #ffffff 60%);
        }

        .app {
            max-width: 960px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 0.25rem;
            color: #111827;
        }

        p {
            margin-top: 0;
            color: #6b7280;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
        }

        .card {
            background: #fff;
            border-radius: 1rem;
            padding: 1.25rem;
            box-shadow: 0 10px 30px rgba(15, 23, 42, 0.06);
            border: 1px solid rgba(15, 23, 42, 0.05);
        }

        .card h2 {
            margin: 0;
            font-size: 0.95rem;
            color: #6b7280;
        }

        .card strong {
            display: block;
            margin-top: 0.4rem;
            font-size: 1.4rem;
        }

        .card.receita strong {
            color: #16a34a;
        }

        .card.despesa strong {
            color: #dc2626;
        }

        .card.saldo strong {
            color: #2563eb;
        }

        form {
            display: grid;
            gap: 0.75rem;
            margin-top: 1rem;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        }

        label {
            font-weight: 600;
            font-size: 0.9rem;
            color: #374151;
        }

        input, select, button {
            width: 100%;
            padding: 0.65rem 0.75rem;
            border-radius: 0.65rem;
            border: 1px solid #e5e7eb;
            font-size: 0.95rem;
            font-family: inherit;
        }

        button {
            background: #2563eb;
            border: none;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        button:hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 15px rgba(37, 99, 235, 0.25);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            background: white;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(15, 23, 42, 0.05);
        }

        th, td {
            padding: 0.85rem 1rem;
            text-align: left;
        }

        thead {
            background: #f9fafb;
            font-size: 0.9rem;
            color: #6b7280;
        }

        tbody tr + tr {
            border-top: 1px solid #f3f4f6;
        }

        .tipo {
            font-weight: 600;
            font-size: 0.85rem;
            padding: 0.25rem 0.65rem;
            border-radius: 999px;
            width: fit-content;
        }

        .tipo.receita {
            background: rgba(34, 197, 94, 0.12);
            color: #059669;
        }

        .tipo.despesa {
            background: rgba(248, 113, 113, 0.15);
            color: #dc2626;
        }

        .mensagem {
            margin-top: 1rem;
            border-radius: 0.75rem;
            padding: 0.75rem 1rem;
            background: rgba(34, 197, 94, 0.12);
            color: #047857;
            font-weight: 600;
        }

        .erro {
            color: #dc2626;
            font-size: 0.8rem;
            font-weight: 600;
        }
    </style>
</head>
<body>
<div class="app">
    <header>
        <h1>Controle de Gastos</h1>
        <p>Monitore entradas, saídas e saldo atualizado</p>
    </header>

    <section class="grid">
        <article class="card receita">
            <h2>Total de receitas</h2>
            <strong th:text="${#numbers.formatDecimal(totalReceitas, 1, 'COMMA', 2, 'POINT')}">R$ 0,00</strong>
        </article>
        <article class="card despesa">
            <h2>Total de despesas</h2>
            <strong th:text="${#numbers.formatDecimal(totalDespesas, 1, 'COMMA', 2, 'POINT')}">R$ 0,00</strong>
        </article>
        <article class="card saldo">
            <h2>Saldo</h2>
            <strong th:text="${#numbers.formatDecimal(saldo, 1, 'COMMA', 2, 'POINT')}">R$ 0,00</strong>
        </article>
    </section>

    <section class="card" style="margin-top: 1.5rem;">
        <h2 style="margin-bottom: 0.5rem;">Novo lançamento</h2>
        <form th:action="@{/lancamentos}" th:object="${novoLancamento}" method="post">
            <div>
                <label for="descricao">Descrição</label>
                <input id="descricao" type="text" th:field="*{descricao}" placeholder="Ex.: Salário, Mercado..." />
                <div class="erro" th:if="${#fields.hasErrors('descricao')}" th:errors="*{descricao}"></div>
            </div>
            <div>
                <label for="valor">Valor</label>
                <input id="valor" type="number" min="0.01" step="0.01" th:field="*{valor}" placeholder="0,00" />
                <div class="erro" th:if="${#fields.hasErrors('valor')}" th:errors="*{valor}"></div>
            </div>
            <div>
                <label for="data">Data</label>
                <input id="data" type="date" th:field="*{data}" />
                <div class="erro" th:if="${#fields.hasErrors('data')}" th:errors="*{data}"></div>
            </div>
            <div>
                <label for="tipo">Tipo</label>
                <select id="tipo" th:field="*{tipo}">
                    <option value="" disabled selected>Selecione</option>
                    <option th:each="tipo : ${tiposLancamento}"
                            th:value="${tipo}"
                            th:text="${tipo.descricao}">Tipo</option>
                </select>
                <div class="erro" th:if="${#fields.hasErrors('tipo')}" th:errors="*{tipo}"></div>
            </div>
            <div>
                <label>&nbsp;</label>
                <button type="submit">Adicionar</button>
            </div>
        </form>
        <div class="mensagem" th:if="${mensagemSucesso}" th:text="${mensagemSucesso}"></div>
    </section>

    <section style="margin-top: 1.5rem;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem; gap: 1rem; flex-wrap: wrap;">
            <div>
                <h2 style="margin: 0;">Histórico</h2>
                <span th:text="${#lists.size(lancamentos)} + ' lançamentos'">0 lançamentos</span>
            </div>
            <form method="get" style="display: flex; gap: 0.5rem; align-items: end;">
                <div>
                    <label for="inicio">De</label>
                    <input id="inicio" name="inicio" type="date" th:value="${inicio}" />
                </div>
                <div>
                    <label for="fim">Até</label>
                    <input id="fim" name="fim" type="date" th:value="${fim}" />
                </div>
                <div style="display: flex; gap: 0.5rem;">
                    <button type="submit" style="min-width: 90px;">Filtrar</button>
                    <a href="/" style="padding: 0.65rem 0.75rem; border-radius: 0.65rem; border: 1px solid #e5e7eb; text-decoration: none; color: #111827; font-weight: 600;">Limpar</a>
                </div>
            </form>
        </div>

        <table>
            <thead>
            <tr>
                <th>Descrição</th>
                <th>Tipo</th>
                <th>Valor</th>
                <th>Data</th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${#lists.isEmpty(lancamentos)}">
                <td colspan="5" style="text-align: center; padding: 2rem; color: #9ca3af;">
                    Nenhum lançamento cadastrado ainda.
                </td>
            </tr>
            <tr th:each="lancamento : ${lancamentos}">
                <td th:text="${lancamento.descricao}">Descrição</td>
                <td>
                    <span class="tipo" th:text="${lancamento.tipo.descricao}"
                          th:classappend="${lancamento.tipo.name().toLowerCase()}"></span>
                </td>
                <td th:text="${#numbers.formatDecimal(lancamento.valor, 1, 'COMMA', 2, 'POINT')}">R$ 0,00</td>
                <td th:text="${#temporals.format(lancamento.data, 'dd/MM/yyyy')}">01/01/2024</td>
                <td>
                    <form th:action="@{'/lancamentos/' + ${lancamento.id} + '/excluir'}" method="post">
                        <button type="submit" style="background: #f3f4f6; color: #374151; border: none;">Excluir</button>
                    </form>
                </td>
            </tr>
            </tbody>
        </table>
    </section>
</div>
</body>
</html>

